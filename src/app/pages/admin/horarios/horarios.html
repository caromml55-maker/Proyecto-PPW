<div class="admin-page">
  <header class="admin-header">
    <div class="header-content">
      <h1>Registro de Disponibilidad</h1>
      <div class="header-actions">
        <button class="btn btn-secondary" routerLink="/admin1"> Inicio</button>
      </div>
    </div>
  </header>

  <div class="admin-content container">

    <div class="selector-container">

      <!-- SELECTOR DE PROGRAMADOR -->
      <label>Seleccionar programador:</label>
      <select [(ngModel)]="selectedProgId" (change)="onProgramadorSelected()" class="form-select">
        <option value="">-- Selecciona --</option>
        @for(p of programadores; track p.id){
          <option [value]="p.id">{{ p.name }} ({{ p.email }})</option>
        }
      </select>

    </div>

    <br><br>

    <div class="form-grid" *ngIf="selectedProgId">
      <label>Fecha:</label>
      <input type="date" [(ngModel)]="fecha" [min]="getFechaMinima()" [max]="getFechaMaxima()" (change)="validarFormulario()">

      <label>Hora inicio:</label>
      <input type="time" [(ngModel)]="horaInicio" (change)="onHoraInicioChange($event)" (change)="validarFormulario()">

      <label>Hora fin:</label>
      <input type="time" [(ngModel)]="horaFin" (change)="onHoraFinChange($event)" (change)="validarFormulario()">

      <!-- Mensaje de error -->
      <div *ngIf="mensajeError" class="error-message">
        {{ mensajeError }}
      </div>

      <div class="action-buttons">
        <button class="btn btn-success" (click)="guardarHorario()" [disabled]="!isFormValid">ðŸ’¾ Guardar horario</button>
      </div>
    </div>
    
   <!-- InformaciÃ³n de horarios -->
  <div class="calendar-section" *ngIf="selectedProgId">
    <h2>Calendario de {{ getNombreProgramador() }}</h2>
    
    <div class="alert alert-info" *ngIf="horarios.length > 0">
      ðŸ“… {{ horarios.length }} horario(s) registrado(s) - 
      <small>Haz clic en un evento para eliminarlo</small>
    </div>
    
    <div class="alert alert-warning" *ngIf="horarios.length === 0">
      No hay horarios registrados para este programador
    </div>

    <div class="calendar-container">
      <full-calendar [options]="calendarOptions"></full-calendar>
    </div>
  </div>

    <!-- Mensaje cuando no hay programador seleccionado -->
    <div *ngIf="!selectedProgId" class="alert alert-info">
       Selecciona un programador para gestionar sus horarios
    </div>


  </div>
  <router-outlet></router-outlet> 
</div>
